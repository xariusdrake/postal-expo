{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/xrs/DATA/Project/postalvn/postal-mobile/screens/postal/scanQR.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport * as Permissions from \"expo-permissions\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useQuery, useLazyQuery } from \"@apollo/client\";\nimport { Button } from \"@ui-kitten/components\";\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\nimport appConfigs from \"../../config\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport ScanSVG from \"../../components/ScanSVG\";\nimport { QUERY_GET_POSTAL_BY_BARCODE } from \"../../graphql/query\";\n\nfunction ScanQRScreen(props) {\n  var _useLazyQuery = useLazyQuery(QUERY_GET_POSTAL_BY_BARCODE, {\n    fetchPolicy: \"no-cache\",\n    onCompleted: function onCompleted() {\n      console.log(\"onCompleted\");\n      console.log(dataPostal);\n      console.log(\"done getPostal\");\n      setScanMode(true);\n      setLoading(false);\n\n      if (dataPostal.postals.length > 0) {\n        navigation.navigate(\"Postal\", {\n          postal: dataPostal.postals[0]\n        });\n      } else {\n        console.log(\"không tìm được\");\n        Alert.alert(\"Không tìm thấy địa điểm\");\n      }\n    },\n    onError: function onError() {\n      console.log(\"onError\");\n      console.log(errorPostal);\n    }\n  }),\n      _useLazyQuery2 = _slicedToArray(_useLazyQuery, 2),\n      getPostal = _useLazyQuery2[0],\n      _useLazyQuery2$ = _useLazyQuery2[1],\n      networkStatus = _useLazyQuery2$.networkStatus,\n      errorPostal = _useLazyQuery2$.error,\n      calledPostal = _useLazyQuery2$.called,\n      loadingPostal = _useLazyQuery2$.loading,\n      dataPostal = _useLazyQuery2$.data;\n\n  var navigation = useNavigation();\n  var windowHeight = Dimensions.get(\"window\").height;\n  var windowWidth = Dimensions.get(\"window\").width;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      clicked = _useState2[0],\n      setClicked = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      hasPermission = _useState4[0],\n      setHasPermission = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loader = _useState6[0],\n      setLoader = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      scanMode = _useState8[0],\n      setScanMode = _useState8[1];\n\n  var _useState9 = useState(true),\n      _useState10 = _slicedToArray(_useState9, 2),\n      loading = _useState10[0],\n      setLoading = _useState10[1];\n\n  useEffect(function () {\n    (function _callee() {\n      var response;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n            case 2:\n              response = _context.sent;\n\n              if (response.status == \"granted\") {\n                setHasPermission(true);\n              } else {\n                setHasPermission(false);\n                Alert.alert(\"Quyền truy cập Camera không được cấp. Vào cài đặt để đặt lại.\");\n                setClicked(false);\n              }\n\n              setLoading(false);\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  function askPermissions() {\n    var response;\n    return _regeneratorRuntime.async(function askPermissions$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n          case 2:\n            response = _context2.sent;\n            console.log(\"askPermissions CAMERA\");\n            console.log(response);\n\n            if (response.status == \"granted\") {\n              setHasPermission(true);\n            } else {\n              setHasPermission(false);\n              Alert.alert(\"Quyền truy cập Camera không được cấp. Vào cài đặt để đặt lại.\");\n              setClicked(false);\n            }\n\n            setLoading(false);\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  var handleBarCodeScanned = function handleBarCodeScanned(_ref) {\n    var type, data;\n    return _regeneratorRuntime.async(function handleBarCodeScanned$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            type = _ref.type, data = _ref.data;\n            console.log(236, type, data);\n            console.log(237, loading, scanMode, loadingPostal);\n\n            if (!loadingPostal) {\n              setScanMode(false);\n              setLoading(true);\n              getPostal({\n                variables: {\n                  code: data\n                }\n              });\n            }\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var responseCamera = Permissions.askAsync(Permissions.CAMERA);\n  return React.createElement(View, {\n    style: {\n      flex: 1,\n      flexDirection: \"column\",\n      justifyContent: \"flex-end\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 3\n    }\n  }, hasPermission != true && React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: {\n      width: windowWidth,\n      flexGrow: 1,\n      justifyContent: \"center\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 6\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      setScanMode(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }\n  })), React.createElement(View, {\n    style: {\n      flex: 1,\n      flexDirection: \"column\",\n      justifyContent: \"flex-end\",\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 6\n    }\n  }, React.createElement(Text, {\n    style: {\n      paddingBottom: 20\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }\n  }, \"Kh\\xF4ng th\\u1EC3 truy c\\u1EADp camera\"), React.createElement(Button, {\n    onPress: function onPress() {\n      console.log(clicked);\n      setClicked(true);\n      askPermissions();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 7\n    }\n  }, \"C\\u1EA5p quy\\u1EC1n CAMERA\")), React.createElement(View, {\n    style: {\n      width: windowWidth,\n      flexGrow: 1\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 6\n    }\n  }, React.createElement(Text, {\n    style: {\n      height: 34\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 7\n    }\n  }))), hasPermission == true && React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 5\n    }\n  }, React.createElement(BarCodeScanner, {\n    onBarCodeScanned: loading == false ? handleBarCodeScanned : undefined,\n    style: StyleSheet.absoluteFillObject,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 6\n    }\n  }), React.createElement(View, {\n    style: {\n      position: \"absolute\",\n      height: \"100%\",\n      top: 0,\n      flex: 1,\n      flexDirection: \"column\",\n      justifyContent: \"space-between\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 6\n    }\n  }, React.createElement(View, {\n    style: {\n      width: windowWidth,\n      flexGrow: 1,\n      justifyContent: \"center\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: {\n      width: windowWidth,\n      flexGrow: 12,\n      flex: 1,\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }\n  }, React.createElement(ScanSVG, {\n    style: {\n      color: \"#0469c1\",\n      borderColor: \"#0469c1\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 8\n    }\n  })), React.createElement(View, {\n    style: {\n      width: windowWidth,\n      flexGrow: 1\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: {\n      height: 34\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 8\n    }\n  }))), loading == true && loadingPostal != true && React.createElement(Button, {\n    onPress: function onPress() {\n      setScanMode(true);\n      setLoading(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 7\n    }\n  }, \"Qu\\xE9t l\\u1EA1i\"), loadingPostal == true && React.createElement(Button, {\n    status: \"basic\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 7\n    }\n  }, \"\\u0110ang x\\u1EED l\\xFD\"), !hasPermission && React.createElement(Button, {\n    onPress: function onPress() {\n      askPermissions();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 7\n    }\n  }, \"C\\u1EA5p quy\\u1EC1n\")));\n}\n\nvar stylesX = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingHorizontal: 25,\n    backgroundColor: \"#FFFFFF\"\n  },\n  loadingView: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"transparent\"\n  }\n});\nexport default ScanQRScreen;","map":{"version":3,"sources":["/Users/xrs/DATA/Project/postalvn/postal-mobile/screens/postal/scanQR.js"],"names":["React","useState","useEffect","Permissions","useNavigation","useQuery","useLazyQuery","Button","BarCodeScanner","appConfigs","Ionicons","ScanSVG","QUERY_GET_POSTAL_BY_BARCODE","ScanQRScreen","props","fetchPolicy","onCompleted","console","log","dataPostal","setScanMode","setLoading","postals","length","navigation","navigate","postal","Alert","alert","onError","errorPostal","getPostal","networkStatus","error","calledPostal","called","loadingPostal","loading","data","windowHeight","Dimensions","get","height","windowWidth","width","clicked","setClicked","hasPermission","setHasPermission","loader","setLoader","scanMode","askAsync","CAMERA","response","status","askPermissions","handleBarCodeScanned","type","variables","code","responseCamera","flex","flexDirection","justifyContent","flexGrow","alignItems","paddingBottom","undefined","StyleSheet","absoluteFillObject","position","top","color","borderColor","stylesX","create","container","paddingHorizontal","backgroundColor","loadingView"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n\tStyleSheet,\n\tText,\n\tImage,\n\tView,\n\tTouchableOpacity,\n\tImageBackground,\n\tTouchableWithoutFeedback,\n\tKeyboard,\n\tKeyboardAvoidingView,\n\tDimensions,\n\tAlert,\n} from \"react-native\";\nimport * as Permissions from \"expo-permissions\";\n\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useQuery, useLazyQuery } from \"@apollo/client\";\nimport { Button } from \"@ui-kitten/components\";\n\nimport { BarCodeScanner } from \"expo-barcode-scanner\";\nimport appConfigs from \"../../config\";\n\nimport { Ionicons } from \"@expo/vector-icons\";\nimport ScanSVG from \"../../components/ScanSVG\";\n\nimport { QUERY_GET_POSTAL_BY_BARCODE } from \"../../graphql/query\";\n\nfunction ScanQRScreen(props) {\n\tconst [\n\t\tgetPostal,\n\t\t{\n\t\t\tnetworkStatus,\n\t\t\terror: errorPostal,\n\t\t\tcalled: calledPostal,\n\t\t\tloading: loadingPostal,\n\t\t\tdata: dataPostal,\n\t\t},\n\t] = useLazyQuery(QUERY_GET_POSTAL_BY_BARCODE, {\n\t\tfetchPolicy: \"no-cache\",\n\t\tonCompleted: () => {\n\t\t\tconsole.log(\"onCompleted\");\n\t\t\tconsole.log(dataPostal);\n\t\t\t// console.log(dataPostal.postals[0].id)\n\n\t\t\t// setLoading(false)\n\t\t\t//\n\t\t\tconsole.log(\"done getPostal\");\n\n\t\t\tsetScanMode(true);\n\t\t\tsetLoading(false);\n\n\t\t\tif (dataPostal.postals.length > 0) {\n\t\t\t\tnavigation.navigate(\"Postal\", {\n\t\t\t\t\tpostal: dataPostal.postals[0],\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.log(\"không tìm được\");\n\t\t\t\tAlert.alert(\"Không tìm thấy địa điểm\");\n\t\t\t}\n\t\t},\n\t\tonError: () => {\n\t\t\tconsole.log(\"onError\");\n\t\t\tconsole.log(errorPostal);\n\t\t},\n\t});\n\n\tconst navigation = useNavigation();\n\n\tconst windowHeight = Dimensions.get(\"window\").height;\n\tconst windowWidth = Dimensions.get(\"window\").width;\n\n\tconst [clicked, setClicked] = useState(false);\n\n\tconst [hasPermission, setHasPermission] = useState(null);\n\n\tconst [loader, setLoader] = useState(false);\n\n\tconst [scanMode, setScanMode] = useState(true);\n\tconst [loading, setLoading] = useState(true);\n\n\t// const [permission, askForPermission] = usePermissions(null);\n\t// const [searchResult, setSearchResult] = useState();\n\n\t// async function ifDisablePermissionCamera() {\n\t// \tconst { status } = await Permissions.getAsync(Permissions.CAMERA);\n\n\t// \tif (status !== \"granted\") {\n\t// \t\tsetHasPermission(false);\n\t// \t}\n\t// }\n\n\tuseEffect(() => {\n\t\t(async () => {\n\t\t\t// const { status } = await Permissions.askAsync(Permissions.CAMERA);\n\t\t\tvar response = await Permissions.askAsync(Permissions.CAMERA);\n\t\t\t// setHasPermission(response.status === \"granted\");\n\n\t\t\tif (response.status == \"granted\") {\n\t\t\t\tsetHasPermission(true);\n\t\t\t} else {\n\t\t\t\tsetHasPermission(false);\n\n\t\t\t\t// if (clicked == true) {\n\t\t\t\tAlert.alert(\n\t\t\t\t\t\"Quyền truy cập Camera không được cấp. Vào cài đặt để đặt lại.\"\n\t\t\t\t);\n\t\t\t\tsetClicked(false);\n\t\t\t\t// }\n\t\t\t}\n\n\t\t\tsetLoading(false);\n\t\t})();\n\t}, []);\n\n\tasync function askPermissions() {\n\t\t// console.log('#6 demande la permision')\n\t\tvar response = await Permissions.askAsync(Permissions.CAMERA);\n\n\t\tconsole.log(\"askPermissions CAMERA\");\n\t\tconsole.log(response);\n\n\t\tif (response.status == \"granted\") {\n\t\t\tsetHasPermission(true);\n\t\t} else {\n\t\t\tsetHasPermission(false);\n\n\t\t\t// if (clicked == true) {\n\t\t\tAlert.alert(\n\t\t\t\t\"Quyền truy cập Camera không được cấp. Vào cài đặt để đặt lại.\"\n\t\t\t);\n\t\t\tsetClicked(false);\n\t\t\t// }\n\t\t}\n\n\t\tsetLoading(false);\n\t}\n\n\t// useEffect(() => {\n\t// \t// ifDisablePermissionCamera();\n\t// \taskPermissions();\n\t// }, []);\n\n\t// successfully scan something\n\tconst handleBarCodeScanned = async ({ type, data }) => {\n\t\tconsole.log(236, type, data);\n\t\tconsole.log(237, loading, scanMode, loadingPostal);\n\n\t\tif (!loadingPostal) {\n\t\t\tsetScanMode(false);\n\t\t\tsetLoading(true);\n\n\t\t\tgetPostal({ variables: { code: data } });\n\t\t}\n\t};\n\n\t// if (\n\t// \tloading == false &&\n\t// \t(hasPermission === false || hasPermission == null)\n\t// ) {\n\t// \treturn (\n\t// \t\t<View\n\t// \t\t\tstyle={{\n\t// \t\t\t\tposition: \"absolute\",\n\t// \t\t\t\theight: \"100%\",\n\t// \t\t\t\ttop: 0,\n\t// \t\t\t\tflex: 1,\n\t// \t\t\t\tflexDirection: \"column\",\n\t// \t\t\t\tjustifyContent: \"space-between\",\n\t// \t\t\t}}\n\t// \t\t>\n\t// \t\t\t<View\n\t// \t\t\t\tstyle={{\n\t// \t\t\t\t\twidth: windowWidth,\n\t// \t\t\t\t\tflexGrow: 1,\n\t// \t\t\t\t\tjustifyContent: \"center\",\n\t// \t\t\t\t}}\n\t// \t\t\t>\n\t// \t\t\t\t<TouchableOpacity\n\t// \t\t\t\t\tonPress={() => {\n\t// \t\t\t\t\t\tsetScanMode(false);\n\t// \t\t\t\t\t}}\n\t// \t\t\t\t>\n\t// \t\t\t\t\t<Ionicons\n\t// \t\t\t\t\t\tname=\"md-close\"\n\t// \t\t\t\t\t\tsize={34}\n\t// \t\t\t\t\t\tcolor={\"#2DB08C\"}\n\t// \t\t\t\t\t\tstyle={{ textAlign: \"right\", marginRight: 34 }}\n\t// \t\t\t\t\t\tonPress={() => navigation.navigate(\"Explore\")}\n\t// \t\t\t\t\t/>\n\t// \t\t\t\t</TouchableOpacity>\n\t// \t\t\t</View>\n\n\t// \t\t\t<View\n\t// \t\t\t\tstyle={{\n\t// \t\t\t\t\tflex: 1,\n\t// \t\t\t\t\tflexDirection: \"column\",\n\t// \t\t\t\t\tjustifyContent: \"flex-end\",\n\t// \t\t\t\t\tjustifyContent: \"center\",\n\t// \t\t\t\t\talignItems: \"center\",\n\t// \t\t\t\t}}\n\t// \t\t\t>\n\t// \t\t\t\t<Text style={{ paddingBottom: 20 }}>\n\t// \t\t\t\t\tKhông thể truy cập camera\n\t// \t\t\t\t</Text>\n\t// \t\t\t\t<Button\n\t// \t\t\t\t\tonPress={() => {\n\t// \t\t\t\t\t\tconsole.log(clicked);\n\t// \t\t\t\t\t\tsetClicked(true);\n\t// \t\t\t\t\t\taskPermissions();\n\t// \t\t\t\t\t}}\n\t// \t\t\t\t>\n\t// \t\t\t\t\tCấp quyền CAMERA\n\t// \t\t\t\t</Button>\n\t// \t\t\t</View>\n\n\t// \t\t\t<View style={{ width: windowWidth, flexGrow: 1 }}>\n\t// \t\t\t\t<Text style={{ height: 34 }}></Text>\n\t// \t\t\t</View>\n\t// \t\t</View>\n\t// \t);\n\t// }\n\n\tlet responseCamera = Permissions.askAsync(Permissions.CAMERA);\n\n\treturn (\n\t\t<View\n\t\t\tstyle={{\n\t\t\t\tflex: 1,\n\t\t\t\tflexDirection: \"column\",\n\t\t\t\tjustifyContent: \"flex-end\",\n\t\t\t}}\n\t\t>\n\t\t\t{hasPermission != true && (\n\t\t\t\t<React.Fragment>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t\tflexGrow: 1,\n\t\t\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<TouchableOpacity\n\t\t\t\t\t\t\tonPress={() => {\n\t\t\t\t\t\t\t\tsetScanMode(false);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t></TouchableOpacity>\n\t\t\t\t\t</View>\n\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\tflexDirection: \"column\",\n\t\t\t\t\t\t\tjustifyContent: \"flex-end\",\n\t\t\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Text style={{ paddingBottom: 20 }}>\n\t\t\t\t\t\t\tKhông thể truy cập camera\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonPress={() => {\n\t\t\t\t\t\t\t\tconsole.log(clicked);\n\t\t\t\t\t\t\t\tsetClicked(true);\n\t\t\t\t\t\t\t\taskPermissions();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCấp quyền CAMERA\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</View>\n\n\t\t\t\t\t<View style={{ width: windowWidth, flexGrow: 1 }}>\n\t\t\t\t\t\t<Text style={{ height: 34 }}></Text>\n\t\t\t\t\t</View>\n\t\t\t\t</React.Fragment>\n\t\t\t)}\n\n\t\t\t{hasPermission == true && (\n\t\t\t\t<React.Fragment>\n\t\t\t\t\t<BarCodeScanner\n\t\t\t\t\t\tonBarCodeScanned={\n\t\t\t\t\t\t\tloading == false ? handleBarCodeScanned : undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyle={StyleSheet.absoluteFillObject}\n\t\t\t\t\t/>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\t\theight: \"100%\",\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\tflexDirection: \"column\",\n\t\t\t\t\t\t\tjustifyContent: \"space-between\",\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<View\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t\t\tflexGrow: 1,\n\t\t\t\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t></View>\n\t\t\t\t\t\t<View\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\t\t\t\tflexGrow: 12,\n\t\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\t\tjustifyContent: \"center\",\n\t\t\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ScanSVG\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tcolor: \"#0469c1\",\n\t\t\t\t\t\t\t\t\tborderColor: \"#0469c1\",\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t\t<View style={{ width: windowWidth, flexGrow: 1 }}>\n\t\t\t\t\t\t\t<Text style={{ height: 34 }}></Text>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</View>\n\t\t\t\t\t{loading == true && loadingPostal != true && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonPress={() => {\n\t\t\t\t\t\t\t\tsetScanMode(true);\n\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tQuét lại\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{loadingPostal == true && (\n\t\t\t\t\t\t<Button status=\"basic\">Đang xử lý</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{!hasPermission && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonPress={() => {\n\t\t\t\t\t\t\t\taskPermissions();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCấp quyền\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</React.Fragment>\n\t\t\t)}\n\t\t</View>\n\t);\n}\n\nconst stylesX = StyleSheet.create({\n\tcontainer: {\n\t\tflex: 1,\n\t\tjustifyContent: \"center\",\n\t\talignItems: \"center\",\n\t\tpaddingHorizontal: 25,\n\t\tbackgroundColor: \"#FFFFFF\",\n\t},\n\tloadingView: {\n\t\tflex: 1,\n\t\tjustifyContent: \"center\",\n\t\talignItems: \"center\",\n\t\tbackgroundColor: \"transparent\",\n\t},\n});\n\nexport default ScanQRScreen;\n"]},"metadata":{},"sourceType":"module"}