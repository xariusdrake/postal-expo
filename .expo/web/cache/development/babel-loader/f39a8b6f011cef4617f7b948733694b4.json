{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/nemonodoy/DATA/Source/PostalCode/postal-mobile/screens/postal/createPostal.js\";\nimport React, { useState, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport { connect } from \"react-redux\";\nimport * as Location from \"expo-location\";\nimport * as Permissions from \"expo-permissions\";\nimport { Layout, Input, Button, Text } from \"@ui-kitten/components\";\nimport Geocode from \"react-geocode\";\nimport MapView from \"react-native-maps\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { Entypo } from \"@expo/vector-icons\";\nimport { useMutation } from \"@apollo/client\";\nimport { MUTATION_CREATE_POSTAL } from \"../../graphql/query\";\nimport appConfigs from \"../../config\";\nGeocode.setApiKey(appConfigs.GOOGLE_MAP.API_KEY_2);\n\nfunction createPostalScreen(props) {\n  var _useMutation = useMutation(MUTATION_CREATE_POSTAL, {\n    onCompleted: function onCompleted(dataCreatePostal) {\n      console.log(\"onCompleted\");\n      console.log(dataCreatePostal);\n\n      if (dataCreatePostal.insert_postals.returning[0].id) {\n        props.navigation.navigate(\"MyPostaL\");\n      } else {\n        console.log(\"some errror in response\");\n      }\n    },\n    onError: function onError(queryError) {\n      console.log(\"onError\");\n      console.log(queryError);\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      createPostal = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      queryLoading = _useMutation2$.loading,\n      queryError = _useMutation2$.error,\n      dataCreatePostal = _useMutation2$.data;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      nameInput = _useState2[0],\n      setNameInput = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      addressInput = _useState4[0],\n      setAddressInput = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentLat = _useState6[0],\n      setCurrentLat = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      currentLong = _useState8[0],\n      setCurrentLong = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      currentAddress = _useState10[0],\n      setCurrentAddress = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      loadingAddress = _useState12[0],\n      setLoadingAddress = _useState12[1];\n\n  useEffect(function () {\n    if (!props.token) {\n      props.navigation.navigate(\"SignIn\");\n    }\n\n    console.log(\"appConfigs.GOOGLE_MAP.API_KEY_2\", appConfigs.GOOGLE_MAP.API_KEY_2);\n\n    function askPermissions() {\n      var response, location;\n      return _regeneratorRuntime.async(function askPermissions$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n            case 2:\n              response = _context.sent;\n              console.log(\"askPermissions response\");\n              console.log(response);\n\n              if (!(response.status == \"granted\")) {\n                _context.next = 16;\n                break;\n              }\n\n              setLoadingAddress(true);\n              console.log(\"askPermissions granted\");\n              _context.next = 10;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync());\n\n            case 10:\n              location = _context.sent;\n              console.log(location);\n\n              if (location.coords.latitude != null && location.coords.longitude != null) {\n                setCurrentLat(location.coords.latitude);\n                setCurrentLong(location.coords.longitude);\n              }\n\n              Geocode.fromLatLng(location.coords.latitude, location.coords.longitude).then(function (response) {\n                var address = response.results[0].formatted_address;\n                setAddressInput(address);\n                setLoadingAddress(false);\n                console.log(address);\n              }, function (error) {\n                console.error(error);\n              });\n              _context.next = 17;\n              break;\n\n            case 16:\n              console.log(\"else\");\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    askPermissions();\n  }, []);\n\n  function onCreateClicked() {\n    console.log(132, props.infos);\n    createPostal({\n      variables: {\n        name: nameInput,\n        address: addressInput,\n        type: 2,\n        image_url: \"https://i.imgur.com/fkmKq6F.png\",\n        lat: currentLat.toString(),\n        lng: currentLong.toString(),\n        uid: props.infos.id\n      }\n    });\n  }\n\n  if (!props.token) {\n    props.navigation.navigate(\"SignIn\");\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 3\n    }\n  }, React.createElement(View, {\n    style: styles.head,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 4\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return props.navigation.goBack();\n    },\n    title: \"Dismiss\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 5\n    }\n  }, React.createElement(Ionicons, {\n    name: \"md-close\",\n    size: 34,\n    color: \"#879299\",\n    style: {\n      position: \"absolute\",\n      alignSelf: \"flex-end\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 6\n    }\n  }))), React.createElement(View, {\n    style: {\n      alignSelf: \"center\",\n      marginBottom: 20,\n      paddingTop: 25\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 4\n    }\n  }, React.createElement(Text, {\n    status: \"primary\",\n    category: \"h5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 5\n    }\n  }, \"\\u0110\\u0103ng k\\xFD m\\xE3 b\\u01B0u ch\\xEDnh\")), React.createElement(View, {\n    style: {\n      padding: 20\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 4\n    }\n  }, React.createElement(Text, {\n    style: {\n      marginTop: 5,\n      paddingTop: 6,\n      paddingBottom: 8\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 5\n    }\n  }, \"T\\xEAn \\u0111\\u1ECBa \\u0111i\\u1EC3m\"), React.createElement(Input, {\n    placeholder: \"\",\n    value: nameInput,\n    onChangeText: function onChangeText(text) {\n      return setNameInput(text);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 5\n    }\n  }), React.createElement(Text, {\n    style: {\n      marginTop: 5,\n      paddingTop: 6,\n      paddingBottom: 8\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 5\n    }\n  }, \"\\u0110\\u1ECBa ch\\u1EC9\", \" \", loadingAddress == true ? \"(Đang xác địa địa chỉ của bạn)\" : \"\"), React.createElement(Input, {\n    placeholder: \"\",\n    value: addressInput,\n    onChangeText: function onChangeText(text) {\n      return setAddressInput(text);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 5\n    }\n  }), currentLat != null && currentLong != null && React.createElement(MapView, {\n    initialRegion: {\n      latitude: currentLat,\n      longitude: currentLong,\n      latitudeDelta: 0.009,\n      longitudeDelta: 0.001\n    },\n    showsUserLocation: true,\n    showsMyLocationButton: true,\n    followsUserLocation: true,\n    showsMyLocationButton: true,\n    loadingEnabled: true,\n    style: styles.mapStyle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 6\n    }\n  }, React.createElement(MapView.Marker, {\n    title: \"Hiện tại\",\n    key: 1,\n    coordinate: {\n      latitude: currentLat,\n      longitude: currentLong\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }\n  })), React.createElement(Button, {\n    style: {\n      marginTop: 15\n    },\n    onPress: function onPress() {\n      return onCreateClicked();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 5\n    }\n  }, \"\\u0110\\u0103ng k\\xFD\")));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"flex-start\",\n    backgroundColor: \"#fff\"\n  },\n  head: {\n    backgroundColor: \"#fff\",\n    width: \"100%\",\n    marginTop: 50,\n    marginBottom: 0,\n    paddingHorizontal: 25,\n    paddingVertical: 10,\n    margin: 0,\n    borderBottomColor: \"#879299\",\n    borderBottomWidth: 1,\n    height: 50\n  },\n  mapStyle: {\n    width: Dimensions.get(\"window\").width,\n    height: 275\n  }\n});\n\nfunction mapStateToProps(state) {\n  return {\n    infos: state.infos,\n    token: state.token\n  };\n}\n\nexport default connect(mapStateToProps, null)(createPostalScreen);","map":{"version":3,"sources":["/Users/nemonodoy/DATA/Source/PostalCode/postal-mobile/screens/postal/createPostal.js"],"names":["React","useState","useEffect","connect","Location","Permissions","Layout","Input","Button","Text","Geocode","MapView","Ionicons","Entypo","useMutation","MUTATION_CREATE_POSTAL","appConfigs","setApiKey","GOOGLE_MAP","API_KEY_2","createPostalScreen","props","onCompleted","dataCreatePostal","console","log","insert_postals","returning","id","navigation","navigate","onError","queryError","createPostal","queryLoading","loading","error","data","nameInput","setNameInput","addressInput","setAddressInput","currentLat","setCurrentLat","currentLong","setCurrentLong","currentAddress","setCurrentAddress","loadingAddress","setLoadingAddress","token","askPermissions","askAsync","LOCATION","response","status","getCurrentPositionAsync","location","coords","latitude","longitude","fromLatLng","then","address","results","formatted_address","onCreateClicked","infos","variables","name","type","image_url","lat","toString","lng","uid","styles","container","head","goBack","position","alignSelf","marginBottom","paddingTop","padding","marginTop","paddingBottom","text","latitudeDelta","longitudeDelta","mapStyle","StyleSheet","create","flex","justifyContent","backgroundColor","width","paddingHorizontal","paddingVertical","margin","borderBottomColor","borderBottomWidth","height","Dimensions","get","mapStateToProps","state"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;;;;;;;AASA,SAASC,OAAT,QAAwB,aAAxB;AAEA,OAAO,KAAKC,QAAZ,MAA0B,eAA1B;AACA,OAAO,KAAKC,WAAZ,MAA6B,kBAA7B;AACA,SAASC,MAAT,EAAiBC,KAAjB,EAAwBC,MAAxB,EAAgCC,IAAhC,QAA4C,uBAA5C;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AAGA,SAASC,QAAT,QAAyB,oBAAzB;AACA,SAASC,MAAT,QAAuB,oBAAvB;AAEA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,sBAAT;AAEA,OAAOC,UAAP;AAEAN,OAAO,CAACO,SAAR,CAAkBD,UAAU,CAACE,UAAX,CAAsBC,SAAxC;;AAEA,SAASC,kBAAT,CAA4BC,KAA5B,EAAmC;AAAA,qBAI9BP,WAAW,CAACC,sBAAD,EAAyB;AACvCO,IAAAA,WAAW,EAAE,qBAACC,gBAAD,EAAsB;AAClCC,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYF,gBAAZ;;AAEA,UAAIA,gBAAgB,CAACG,cAAjB,CAAgCC,SAAhC,CAA0C,CAA1C,EAA6CC,EAAjD,EAAqD;AACpDP,QAAAA,KAAK,CAACQ,UAAN,CAAiBC,QAAjB,CAA0B,UAA1B;AACA,OAFD,MAEO;AACNN,QAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACA;AAGD,KAZsC;AAavCM,IAAAA,OAAO,EAAE,iBAACC,UAAD,EAAgB;AACxBR,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYO,UAAZ;AACA;AAhBsC,GAAzB,CAJmB;AAAA;AAAA,MAEjCC,YAFiC;AAAA;AAAA,MAGtBC,YAHsB,kBAG/BC,OAH+B;AAAA,MAGDH,UAHC,kBAGRI,KAHQ;AAAA,MAGiBb,gBAHjB,kBAGWc,IAHX;;AAAA,kBAuBApC,QAAQ,CAAC,EAAD,CAvBR;AAAA;AAAA,MAuB3BqC,SAvB2B;AAAA,MAuBhBC,YAvBgB;;AAAA,mBAwBMtC,QAAQ,CAAC,EAAD,CAxBd;AAAA;AAAA,MAwB3BuC,YAxB2B;AAAA,MAwBbC,eAxBa;;AAAA,mBA0BExC,QAAQ,CAAC,IAAD,CA1BV;AAAA;AAAA,MA0B3ByC,UA1B2B;AAAA,MA0BfC,aA1Be;;AAAA,mBA2BI1C,QAAQ,CAAC,IAAD,CA3BZ;AAAA;AAAA,MA2B3B2C,WA3B2B;AAAA,MA2BdC,cA3Bc;;AAAA,mBA4BU5C,QAAQ,CAAC,IAAD,CA5BlB;AAAA;AAAA,MA4B3B6C,cA5B2B;AAAA,MA4BXC,iBA5BW;;AAAA,oBA6BU9C,QAAQ,CAAC,KAAD,CA7BlB;AAAA;AAAA,MA6B3B+C,cA7B2B;AAAA,MA6BXC,iBA7BW;;AA+BlC/C,EAAAA,SAAS,CAAC,YAAM;AACf,QAAI,CAACmB,KAAK,CAAC6B,KAAX,EAAkB;AACjB7B,MAAAA,KAAK,CAACQ,UAAN,CAAiBC,QAAjB,CAA0B,QAA1B;AACA;;AAEDN,IAAAA,OAAO,CAACC,GAAR,CACC,iCADD,EAECT,UAAU,CAACE,UAAX,CAAsBC,SAFvB;;AAKA,aAAegC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CACsB9C,WAAW,CAAC+C,QAAZ,CAAqB/C,WAAW,CAACgD,QAAjC,CADtB;;AAAA;AACKC,cAAAA,QADL;AAGC9B,cAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAD,cAAAA,OAAO,CAACC,GAAR,CAAY6B,QAAZ;;AAJD,oBAMKA,QAAQ,CAACC,MAAT,IAAmB,SANxB;AAAA;AAAA;AAAA;;AAOEN,cAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACAzB,cAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ;AARF;AAAA,+CAUuBrB,QAAQ,CAACoD,uBAAT,EAVvB;;AAAA;AAUMC,cAAAA,QAVN;AAWEjC,cAAAA,OAAO,CAACC,GAAR,CAAYgC,QAAZ;;AAUA,kBACCA,QAAQ,CAACC,MAAT,CAAgBC,QAAhB,IAA4B,IAA5B,IACAF,QAAQ,CAACC,MAAT,CAAgBE,SAAhB,IAA6B,IAF9B,EAGE;AACDjB,gBAAAA,aAAa,CAACc,QAAQ,CAACC,MAAT,CAAgBC,QAAjB,CAAb;AACAd,gBAAAA,cAAc,CAACY,QAAQ,CAACC,MAAT,CAAgBE,SAAjB,CAAd;AACA;;AAEDlD,cAAAA,OAAO,CAACmD,UAAR,CACCJ,QAAQ,CAACC,MAAT,CAAgBC,QADjB,EAECF,QAAQ,CAACC,MAAT,CAAgBE,SAFjB,EAGEE,IAHF,CAIC,UAACR,QAAD,EAAc;AACb,oBAAMS,OAAO,GAAGT,QAAQ,CAACU,OAAT,CAAiB,CAAjB,EAAoBC,iBAApC;AACAxB,gBAAAA,eAAe,CAACsB,OAAD,CAAf;AACAd,gBAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAzB,gBAAAA,OAAO,CAACC,GAAR,CAAYsC,OAAZ;AACA,eATF,EAUC,UAAC3B,KAAD,EAAW;AACVZ,gBAAAA,OAAO,CAACY,KAAR,CAAcA,KAAd;AACA,eAZF;AA7BF;AAAA;;AAAA;AA8CEZ,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;;AA9CF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAkDA0B,IAAAA,cAAc;AACd,GA7DQ,EA6DN,EA7DM,CAAT;;AA0EA,WAASe,eAAT,GAA2B;AAC1B1C,IAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ,EAAiBJ,KAAK,CAAC8C,KAAvB;AAEAlC,IAAAA,YAAY,CAAC;AACZmC,MAAAA,SAAS,EAAE;AACVC,QAAAA,IAAI,EAAE/B,SADI;AAEVyB,QAAAA,OAAO,EAAEvB,YAFC;AAGV8B,QAAAA,IAAI,EAAE,CAHI;AAIVC,QAAAA,SAAS,EAAE,iCAJD;AAKVC,QAAAA,GAAG,EAAE9B,UAAU,CAAC+B,QAAX,EALK;AAMVC,QAAAA,GAAG,EAAE9B,WAAW,CAAC6B,QAAZ,EANK;AAOVE,QAAAA,GAAG,EAAEtD,KAAK,CAAC8C,KAAN,CAAYvC;AAPP;AADC,KAAD,CAAZ;AAWA;;AAED,MAAI,CAACP,KAAK,CAAC6B,KAAX,EAAkB;AACjB7B,IAAAA,KAAK,CAACQ,UAAN,CAAiBC,QAAjB,CAA0B,QAA1B;AACA;;AAED,SACC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE8C,MAAM,CAACC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAED,MAAM,CAACE,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,gBAAD;AACC,IAAA,OAAO,EAAE;AAAA,aAAMzD,KAAK,CAACQ,UAAN,CAAiBkD,MAAjB,EAAN;AAAA,KADV;AAEC,IAAA,KAAK,EAAC,SAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIC,oBAAC,QAAD;AACC,IAAA,IAAI,EAAC,UADN;AAEC,IAAA,IAAI,EAAE,EAFP;AAGC,IAAA,KAAK,EAAE,SAHR;AAIC,IAAA,KAAK,EAAE;AAAEC,MAAAA,QAAQ,EAAE,UAAZ;AAAwBC,MAAAA,SAAS,EAAE;AAAnC,KAJR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJD,CADD,CAFD,EAgBC,oBAAC,IAAD;AACC,IAAA,KAAK,EAAE;AACNA,MAAAA,SAAS,EAAE,QADL;AAENC,MAAAA,YAAY,EAAE,EAFR;AAGNC,MAAAA,UAAU,EAAE;AAHN,KADR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOC,oBAAC,IAAD;AAAM,IAAA,MAAM,EAAC,SAAb;AAAuB,IAAA,QAAQ,EAAC,IAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oDAPD,CAhBD,EA2BC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,IAAD;AACC,IAAA,KAAK,EAAE;AACNC,MAAAA,SAAS,EAAE,CADL;AAENF,MAAAA,UAAU,EAAE,CAFN;AAGNG,MAAAA,aAAa,EAAE;AAHT,KADR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CADD,EAUC,oBAAC,KAAD;AACC,IAAA,WAAW,EAAC,EADb;AAEC,IAAA,KAAK,EAAEhD,SAFR;AAGC,IAAA,YAAY,EAAE,sBAACiD,IAAD;AAAA,aAAUhD,YAAY,CAACgD,IAAD,CAAtB;AAAA,KAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVD,EAeC,oBAAC,IAAD;AACC,IAAA,KAAK,EAAE;AACNF,MAAAA,SAAS,EAAE,CADL;AAENF,MAAAA,UAAU,EAAE,CAFN;AAGNG,MAAAA,aAAa,EAAE;AAHT,KADR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAOS,GAPT,EAQEtC,cAAc,IAAI,IAAlB,GACE,gCADF,GAEE,EAVJ,CAfD,EA2BC,oBAAC,KAAD;AACC,IAAA,WAAW,EAAC,EADb;AAEC,IAAA,KAAK,EAAER,YAFR;AAGC,IAAA,YAAY,EAAE,sBAAC+C,IAAD;AAAA,aAAU9C,eAAe,CAAC8C,IAAD,CAAzB;AAAA,KAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA3BD,EAgCE7C,UAAU,IAAI,IAAd,IAAsBE,WAAW,IAAI,IAArC,IACA,oBAAC,OAAD;AACC,IAAA,aAAa,EAAE;AACde,MAAAA,QAAQ,EAAEjB,UADI;AAEdkB,MAAAA,SAAS,EAAEhB,WAFG;AAKd4C,MAAAA,aAAa,EAAE,KALD;AAMdC,MAAAA,cAAc,EAAE;AANF,KADhB;AAUC,IAAA,iBAAiB,EAAE,IAVpB;AAWC,IAAA,qBAAqB,EAAE,IAXxB;AAYC,IAAA,mBAAmB,EAAE,IAZtB;AAaC,IAAA,qBAAqB,EAAE,IAbxB;AAcC,IAAA,cAAc,EAAE,IAdjB;AAeC,IAAA,KAAK,EAAEb,MAAM,CAACc,QAff;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAkBC,oBAAC,OAAD,CAAS,MAAT;AACC,IAAA,KAAK,EAAE,UADR;AAEC,IAAA,GAAG,EAAE,CAFN;AAGC,IAAA,UAAU,EAAE;AACX/B,MAAAA,QAAQ,EAAEjB,UADC;AAEXkB,MAAAA,SAAS,EAAEhB;AAFA,KAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAlBD,CAjCF,EA6DC,oBAAC,MAAD;AACC,IAAA,KAAK,EAAE;AAAEyC,MAAAA,SAAS,EAAE;AAAb,KADR;AAEC,IAAA,OAAO,EAAE;AAAA,aAAMnB,eAAe,EAArB;AAAA,KAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BA7DD,CA3BD,CADD;AAkGA;;AAGD,IAAMU,MAAM,GAAGe,UAAU,CAACC,MAAX,CAAkB;AAChCf,EAAAA,SAAS,EAAE;AACVgB,IAAAA,IAAI,EAAE,CADI;AAGVC,IAAAA,cAAc,EAAE,YAHN;AAIVC,IAAAA,eAAe,EAAE;AAJP,GADqB;AAOhCjB,EAAAA,IAAI,EAAE;AACLiB,IAAAA,eAAe,EAAE,MADZ;AAELC,IAAAA,KAAK,EAAE,MAFF;AAGLX,IAAAA,SAAS,EAAE,EAHN;AAILH,IAAAA,YAAY,EAAE,CAJT;AAKLe,IAAAA,iBAAiB,EAAE,EALd;AAMLC,IAAAA,eAAe,EAAE,EANZ;AAOLC,IAAAA,MAAM,EAAE,CAPH;AAQLC,IAAAA,iBAAiB,EAAE,SARd;AASLC,IAAAA,iBAAiB,EAAE,CATd;AAULC,IAAAA,MAAM,EAAE;AAVH,GAP0B;AAoBhCZ,EAAAA,QAAQ,EAAE;AACTM,IAAAA,KAAK,EAAEO,UAAU,CAACC,GAAX,CAAe,QAAf,EAAyBR,KADvB;AAETM,IAAAA,MAAM,EAAE;AAFC;AApBsB,CAAlB,CAAf;;AA0BA,SAASG,eAAT,CAAyBC,KAAzB,EAAgC;AAC/B,SAAO;AAAEvC,IAAAA,KAAK,EAAEuC,KAAK,CAACvC,KAAf;AAAsBjB,IAAAA,KAAK,EAAEwD,KAAK,CAACxD;AAAnC,GAAP;AACA;;AAGD,eAAe/C,OAAO,CAACsG,eAAD,EAAkB,IAAlB,CAAP,CAA+BrF,kBAA/B,CAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n\tView,\n\tStyleSheet,\n\tImage,\n\tImageBackground,\n\tTouchableOpacity,\n\tDimensions,\n} from \"react-native\";\nimport { connect } from \"react-redux\";\n\nimport * as Location from \"expo-location\";\nimport * as Permissions from \"expo-permissions\";\nimport { Layout, Input, Button, Text } from \"@ui-kitten/components\";\nimport Geocode from \"react-geocode\";\nimport MapView from \"react-native-maps\";\n\n// fonts\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { Entypo } from \"@expo/vector-icons\";\n\nimport { useMutation } from \"@apollo/client\";\nimport { MUTATION_CREATE_POSTAL } from \"../../graphql/query\";\n\nimport appConfigs from \"../../config\";\n\nGeocode.setApiKey(appConfigs.GOOGLE_MAP.API_KEY_2);\n\nfunction createPostalScreen(props) {\n\tconst [\n\t\tcreatePostal,\n\t\t{ loading: queryLoading, error: queryError, data: dataCreatePostal },\n\t] = useMutation(MUTATION_CREATE_POSTAL, {\n\t\tonCompleted: (dataCreatePostal) => {\n\t\t\tconsole.log(\"onCompleted\");\n\t\t\tconsole.log(dataCreatePostal);\n\n\t\t\tif (dataCreatePostal.insert_postals.returning[0].id) {\n\t\t\t\tprops.navigation.navigate(\"MyPostaL\");\n\t\t\t} else {\n\t\t\t\tconsole.log(\"some errror in response\");\n\t\t\t}\n\n\t\t\t// setAllPostalList(data.postals);\n\t\t},\n\t\tonError: (queryError) => {\n\t\t\tconsole.log(\"onError\");\n\t\t\tconsole.log(queryError);\n\t\t},\n\t});\n\n\tconst [nameInput, setNameInput] = useState(\"\");\n\tconst [addressInput, setAddressInput] = useState(\"\");\n\n\tconst [currentLat, setCurrentLat] = useState(null);\n\tconst [currentLong, setCurrentLong] = useState(null);\n\tconst [currentAddress, setCurrentAddress] = useState(null);\n\tconst [loadingAddress, setLoadingAddress] = useState(false);\n\n\tuseEffect(() => {\n\t\tif (!props.token) {\n\t\t\tprops.navigation.navigate(\"SignIn\");\n\t\t}\n\n\t\tconsole.log(\n\t\t\t\"appConfigs.GOOGLE_MAP.API_KEY_2\",\n\t\t\tappConfigs.GOOGLE_MAP.API_KEY_2\n\t\t);\n\n\t\tasync function askPermissions() {\n\t\t\tvar response = await Permissions.askAsync(Permissions.LOCATION);\n\n\t\t\tconsole.log(\"askPermissions response\");\n\t\t\tconsole.log(response);\n\n\t\t\tif (response.status == \"granted\") {\n\t\t\t\tsetLoadingAddress(true);\n\t\t\t\tconsole.log(\"askPermissions granted\");\n\n\t\t\t\tlet location = await Location.getCurrentPositionAsync();\n\t\t\t\tconsole.log(location);\n\t\t\t\t// setCurrentLocation(location);\n\n\t\t\t\t// Location.watchPositionAsync({ distanceInterval: 10 }, (location) => {\n\t\t\t\t// \tconsole.log(\n\t\t\t\t// \t\t\"askPermissions here location: \",\n\t\t\t\t// \t\tlocation.coords.latitude,\n\t\t\t\t// \t\tlocation.coords.longitude\n\t\t\t\t// \t);\n\n\t\t\t\tif (\n\t\t\t\t\tlocation.coords.latitude != null &&\n\t\t\t\t\tlocation.coords.longitude != null\n\t\t\t\t) {\n\t\t\t\t\tsetCurrentLat(location.coords.latitude);\n\t\t\t\t\tsetCurrentLong(location.coords.longitude);\n\t\t\t\t}\n\n\t\t\t\tGeocode.fromLatLng(\n\t\t\t\t\tlocation.coords.latitude,\n\t\t\t\t\tlocation.coords.longitude\n\t\t\t\t).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst address = response.results[0].formatted_address;\n\t\t\t\t\t\tsetAddressInput(address);\n\t\t\t\t\t\tsetLoadingAddress(false);\n\t\t\t\t\t\tconsole.log(address);\n\t\t\t\t\t},\n\t\t\t\t\t(error) => {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// });\n\t\t\t} else {\n\t\t\t\tconsole.log(\"else\");\n\t\t\t}\n\t\t}\n\n\t\taskPermissions();\n\t}, []);\n\n\t// if (queryLoading) return <Text>Loading...</Text>;\n\t// if (queryError) {\n\t//     console.log('queryError')\n\t//     console.log(queryError)\n\t// }\n\n\t// if (dataCreatePostal) {\n\t//     console.log('dataCreatePostal')\n\t//     console.log(dataCreatePostal)\n\t// }\n\n\tfunction onCreateClicked() {\n\t\tconsole.log(132, props.infos);\n\n\t\tcreatePostal({\n\t\t\tvariables: {\n\t\t\t\tname: nameInput,\n\t\t\t\taddress: addressInput,\n\t\t\t\ttype: 2,\n\t\t\t\timage_url: \"https://i.imgur.com/fkmKq6F.png\",\n\t\t\t\tlat: currentLat.toString(),\n\t\t\t\tlng: currentLong.toString(),\n\t\t\t\tuid: props.infos.id,\n\t\t\t},\n\t\t});\n\t}\n\n\tif (!props.token) {\n\t\tprops.navigation.navigate(\"SignIn\");\n\t}\n\n\treturn (\n\t\t<View style={styles.container}>\n\t\t\t{/* header */}\n\t\t\t<View style={styles.head}>\n\t\t\t\t<TouchableOpacity\n\t\t\t\t\tonPress={() => props.navigation.goBack()}\n\t\t\t\t\ttitle=\"Dismiss\"\n\t\t\t\t>\n\t\t\t\t\t<Ionicons\n\t\t\t\t\t\tname=\"md-close\"\n\t\t\t\t\t\tsize={34}\n\t\t\t\t\t\tcolor={\"#879299\"}\n\t\t\t\t\t\tstyle={{ position: \"absolute\", alignSelf: \"flex-end\" }}\n\t\t\t\t\t/>\n\t\t\t\t</TouchableOpacity>\n\t\t\t</View>\n\n\t\t\t<View\n\t\t\t\tstyle={{\n\t\t\t\t\talignSelf: \"center\",\n\t\t\t\t\tmarginBottom: 20,\n\t\t\t\t\tpaddingTop: 25,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Text status=\"primary\" category=\"h5\">\n\t\t\t\t\tĐăng ký mã bưu chính\n\t\t\t\t</Text>\n\t\t\t</View>\n\t\t\t<View style={{ padding: 20 }}>\n\t\t\t\t<Text\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmarginTop: 5,\n\t\t\t\t\t\tpaddingTop: 6,\n\t\t\t\t\t\tpaddingBottom: 8,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tTên địa điểm\n\t\t\t\t</Text>\n\t\t\t\t<Input\n\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\tvalue={nameInput}\n\t\t\t\t\tonChangeText={(text) => setNameInput(text)}\n\t\t\t\t/>\n\t\t\t\t<Text\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tmarginTop: 5,\n\t\t\t\t\t\tpaddingTop: 6,\n\t\t\t\t\t\tpaddingBottom: 8,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tĐịa chỉ{\" \"}\n\t\t\t\t\t{loadingAddress == true\n\t\t\t\t\t\t? \"(Đang xác địa địa chỉ của bạn)\"\n\t\t\t\t\t\t: \"\"}\n\t\t\t\t</Text>\n\t\t\t\t<Input\n\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\tvalue={addressInput}\n\t\t\t\t\tonChangeText={(text) => setAddressInput(text)}\n\t\t\t\t/>\n\t\t\t\t{currentLat != null && currentLong != null && (\n\t\t\t\t\t<MapView\n\t\t\t\t\t\tinitialRegion={{\n\t\t\t\t\t\t\tlatitude: currentLat,\n\t\t\t\t\t\t\tlongitude: currentLong,\n\t\t\t\t\t\t\t// latitudeDelta: appConfigs.GOOGLE_MAP.latitudeDelta,\n\t\t\t\t\t\t\t// longitudeDelta: appConfigs.GOOGLE_MAP.longitudeDelta,\n\t\t\t\t\t\t\tlatitudeDelta: 0.009,\n\t\t\t\t\t\t\tlongitudeDelta: 0.001,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\t//hiển thị chấm xanh\n\t\t\t\t\t\tshowsUserLocation={true}\n\t\t\t\t\t\tshowsMyLocationButton={true}\n\t\t\t\t\t\tfollowsUserLocation={true}\n\t\t\t\t\t\tshowsMyLocationButton={true}\n\t\t\t\t\t\tloadingEnabled={true}\n\t\t\t\t\t\tstyle={styles.mapStyle}\n\t\t\t\t\t\t// customMapStyle={mapStyle}\n\t\t\t\t\t>\n\t\t\t\t\t\t<MapView.Marker\n\t\t\t\t\t\t\ttitle={\"Hiện tại\"}\n\t\t\t\t\t\t\tkey={1}\n\t\t\t\t\t\t\tcoordinate={{\n\t\t\t\t\t\t\t\tlatitude: currentLat,\n\t\t\t\t\t\t\t\tlongitude: currentLong,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MapView>\n\t\t\t\t)}\n\t\t\t\t<Button\n\t\t\t\t\tstyle={{ marginTop: 15 }}\n\t\t\t\t\tonPress={() => onCreateClicked()}\n\t\t\t\t>\n\t\t\t\t\tĐăng ký\n\t\t\t\t</Button>\n\t\t\t</View>\n\t\t</View>\n\t);\n}\n\n// STYLES\nconst styles = StyleSheet.create({\n\tcontainer: {\n\t\tflex: 1,\n\t\t// alignItems: \"center\",\n\t\tjustifyContent: \"flex-start\",\n\t\tbackgroundColor: \"#fff\",\n\t},\n\thead: {\n\t\tbackgroundColor: \"#fff\",\n\t\twidth: \"100%\",\n\t\tmarginTop: 50,\n\t\tmarginBottom: 0,\n\t\tpaddingHorizontal: 25,\n\t\tpaddingVertical: 10,\n\t\tmargin: 0,\n\t\tborderBottomColor: \"#879299\",\n\t\tborderBottomWidth: 1,\n\t\theight: 50,\n\t\t// position: \"absolute\",\n\t},\n\tmapStyle: {\n\t\twidth: Dimensions.get(\"window\").width,\n\t\theight: 275,\n\t},\n});\n\nfunction mapStateToProps(state) {\n\treturn { infos: state.infos, token: state.token };\n}\n\n// keep this line at the end\nexport default connect(mapStateToProps, null)(createPostalScreen);\n"]},"metadata":{},"sourceType":"module"}